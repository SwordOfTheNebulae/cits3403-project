{% extends 'index.html' %}
{% block body %}

<section>
	<h1>{{ movie.title }}</h1>
	<p><strong>Genres:</strong> {{ movie.genre }}</p>
	<p><strong>Year:</strong> {{ movie.release_year }}</p>
	<p><strong>Average Rating:</strong> {{ movie.avg_rating }}/10</p>
</section>

<section>
	<h2>Submit a Review</h2>
	{% if current_user.is_authenticated %}
	<form action="{{ url_for('submit_review', movie_id=movie.id) }}" method="POST">
		<label for="rating">Rating (1â€“10):</label>
		<input type="number" id="rating" name="rating" min="1" max="10" required />

		<label for="review">Review:</label><br />
		<textarea id="review" name="review" rows="4" cols="50" required></textarea><br />

		<button type="submit">Submit</button>
	</form>
	{% else %}
	<p><a href="{{ url_for('login') }}">Log in</a> to submit a review.</p>
	{% endif %}
</section>

<section>
	<h2>Reviews</h2>
	{% if reviews %}
	<ul>
		{% for review in reviews %}
		<li>
			<p><strong>{{ review.user.username }}</strong> rated it {{ review.rating }}/10</p>
			<p>{{ review.text }}</p>
		</li>
		{% endfor %}
	</ul>
	{% else %}
	<p>No reviews yet for this movie.</p>
	{% endif %}
</section>

{% endblock %}
